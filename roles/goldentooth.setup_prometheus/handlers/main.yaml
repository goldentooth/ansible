---
- name: 'Restart Prometheus.'
  ansible.builtin.systemd_service:
    name: 'prometheus'
    state: 'restarted'

- name: 'Restart Nginx on the load balancer.'
  ansible.builtin.systemd_service:
    name: 'nginx'
    state: 'restarted'
  delegate_to: "{{ groups['haproxy'] | first }}"

- name: 'Reload Consul configuration.'
  ansible.builtin.systemd_service:
    name: 'consul'
    state: 'reloaded'