[Unit]
Description=HAProxy Data Plane API
Documentation=https://www.haproxy.com/documentation/haproxy-data-plane-api/
After=network.target haproxy.service
Wants=haproxy.service

[Service]
Type=simple
User=haproxy
Group=haproxy
ExecStart=/usr/local/bin/haproxy-dataplaneapi -f /etc/haproxy-dataplane/dataplaneapi.yaml
ExecReload=/bin/kill -USR2 $MAINPID
Restart=on-failure
RestartSec=5s
StandardOutput=journal
StandardError=journal
SyslogIdentifier=haproxy-dataplaneapi

# Security settings
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/run/haproxy /tmp /var/log /etc/haproxy /etc/haproxy-dataplane /etc/haproxy/maps /etc/haproxy/ssl /etc/haproxy/general /etc/haproxy/spoe /etc/haproxy/acl /etc/haproxy/transactions /tmp/spoe-haproxy
CapabilityBoundingSet=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target